# 脚本管理器 - 桌面客户端

这是一个基于Electron的桌面脚本启动器，用于管理和启动各种类型的脚本（Python、JavaScript、TypeScript、Batch、PowerShell等）。

## 功能特点

- 🖥️ **原生桌面应用**: 基于Electron，提供原生桌面体验
- 🚀 **脚本启动器**: 点击即启动，脚本在独立窗口中运行
- 📁 **多脚本类型支持**: Python、JavaScript、TypeScript、Batch、PowerShell、Bash
- 🎨 **现代化界面**: 卡片网格布局，类似应用商店体验
- 🔍 **智能搜索**: 支持按名称、类型、描述搜索脚本
- 📂 **文件浏览**: 内置文件选择器，方便添加脚本
- 🏷️ **分类管理**: 按脚本类型自动分类和过滤
- ⏰ **定时任务**: 轻量级任务调度器，支持间隔、每日、每周执行
- 🚀 **绿色便携**: 支持打包为便携版可执行文件

## 项目结构

```
scripts-manager-client/
├── app/                    # 应用核心代码
│   ├── main/              # 主进程业务逻辑
│   │   ├── script-manager.js    # 脚本数据管理
│   │   ├── script-executor.js   # 脚本启动引擎
│   │   ├── task-scheduler.js    # 定时任务调度器
│   │   └── file-manager.js      # 文件系统操作
│   ├── renderer/          # 渲染进程（界面）
│   │   ├── index.html     # 主界面
│   │   ├── styles.css     # 样式文件
│   │   └── renderer.js    # 前端逻辑
│   └── data/              # 数据存储
│       ├── scripts.json   # 脚本数据文件
│       └── tasks.json     # 定时任务数据文件
├── example_scripts/       # 示例脚本
│   ├── hello.py          # Python示例
│   └── hello.js          # JavaScript示例
├── memory-bank/          # 项目文档和记忆库
├── main.js               # Electron主进程入口
├── preload.js            # 预加载脚本
├── package.json          # 项目配置
└── README.md             # 项目说明
```

## 安装和运行

### 前提条件

- Node.js (v16+)
- npm

### 开发环境运行

1. **克隆项目**
   ```bash
   git clone <repository-url>
   cd scripts-manager-client
   ```

2. **安装依赖**
   ```bash
   npm install
   ```

3. **启动应用**
   ```bash
   # 普通模式
   npm start

   # 开发模式（带开发者工具）
   npm run dev
   ```

### 打包分发

```bash
# 构建应用
npm run build

# 生成便携版
npm run dist
```

## 使用说明

### 脚本管理

- **添加脚本**: 点击顶部"+"按钮，填写脚本信息
- **编辑脚本**: 右键点击脚本卡片选择"编辑"
- **删除脚本**: 右键点击脚本卡片选择"删除"
- **搜索脚本**: 使用顶部搜索框
- **分类过滤**: 点击分类标签（全部、Python、JavaScript等）

### 定时任务

- **创建定时任务**: 点击顶部⏰按钮，选择"新建任务"
- **管理任务**: 在任务管理界面中编辑、启用/禁用、删除任务
- **快速设置**: 右键点击脚本卡片选择"设置定时"
- **立即执行**: 在任务列表中点击"立即执行"按钮

### 脚本启动

1. 点击脚本卡片
2. 脚本将在新的控制台窗口中启动
3. 脚本独立运行，可以关闭管理器应用

### 支持的脚本类型

- **Python** (.py): 需要安装Python环境
- **JavaScript** (.js): 使用Node.js执行
- **TypeScript** (.ts): 需要安装ts-node
- **Batch** (.bat/.cmd): Windows批处理文件
- **PowerShell** (.ps1): PowerShell脚本
- **Bash** (.sh): Bash脚本（需要WSL或Git Bash）

## 技术架构

### 核心技术栈

- **Electron**: 跨平台桌面应用框架
- **Node.js**: 后端运行时
- **原生JavaScript**: 前端界面
- **JSON**: 数据存储

### 架构设计

- **主进程**: 应用生命周期管理、IPC通信、系统API访问
- **渲染进程**: 用户界面、用户交互
- **IPC通信**: 主进程与渲染进程间的安全通信
- **模块化设计**: 脚本管理、启动、文件操作分离

## 特色功能

### 🔒 安全性
- 上下文隔离和预加载脚本确保安全
- 禁用Node.js集成，防止安全漏洞

### 🌍 国际化
- 完全支持中文路径和文件名
- 正确处理中文脚本输出（GBK/UTF-8编码）

### ⚡ 性能优化
- 禁用GPU加速，避免兼容性问题
- 智能缓存管理
- 异步操作，界面响应流畅

### 🎯 用户体验
- 现代化卡片网格布局
- 脚本在独立窗口中运行
- 响应式界面设计
- 右键菜单操作

## 故障排除

### 常见问题

1. **脚本启动失败**
   - 检查脚本路径是否正确
   - 确认相应运行时环境已安装
   - 查看控制台错误信息

2. **中文显示问题**
   - 应用已优化中文支持
   - 如有问题请检查系统编码设置

3. **权限问题**
   - 确保脚本文件有执行权限
   - PowerShell脚本可能需要调整执行策略

### 开发调试

```bash
# 开发模式启动（带开发者工具）
npm run dev

# 查看详细日志
# 在开发者工具的Console标签页查看
```

## 项目历史

本项目经历了重大重构：

- **v0.x**: Web版本（前后端分离）
- **v1.0**: Electron桌面客户端版本（执行监控器）
- **v1.1.1**: 重构为脚本启动器，现代化界面
- **v1.2.2**: 修复便携版数据持久化问题（当前版本）
- **v1.2.1**: 新增定时任务功能

重构带来的改进：
- 从脚本执行监控器转变为脚本启动器
- 现代化卡片网格界面
- 脚本在独立窗口中运行
- 完善的右键菜单交互系统
- 脚本运行状态跟踪
- 优化的搜索和分类体验
- 轻量级定时任务功能
- 更好的用户体验和稳定性

## 贡献指南

欢迎提交Issue和Pull Request！

## 许可证

MIT License

---

**享受高效的脚本管理体验！** 🚀
