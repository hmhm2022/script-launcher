# 更新日志

## [1.3.9] - 2025-05-27

### 修复
- 🔧 **Windows脚本启动优化**
  - 修复包含空格的脚本名称在Windows平台启动失败的问题
  - 移除start命令中的窗口标题参数，简化命令结构
  - 提升脚本启动的稳定性和兼容性

### 新增
- 📧 **状态栏信息增强**
  - 在状态栏中间位置添加作者邮箱联系方式（windo@linux.do）
  - 新增可点击的GitHub仓库链接，方便用户访问项目主页
  - 优化状态栏布局，采用三栏设计（统计信息-联系信息-更新时间）

### 改进
- 🎨 **用户界面优化**
  - 状态栏信息布局更加平衡和美观
  - GitHub图标使用官方SVG图标，视觉效果更专业
  - 鼠标悬停效果和点击反馈优化

### 技术细节
- 修复script-executor.js中Windows平台的start命令参数
- 在状态栏添加status-center区域支持三栏布局
- 新增openExternal API支持打开外部链接
- 完善CSS样式支持GitHub图标和邮箱链接

## [1.3.8] - 2025-05-27

### 修复
- 🔧 **脚本删除时定时任务自动清理**
  - 修复脚本删除时定时任务未自动清理的数据一致性问题
  - 删除脚本时现在会自动清理所有相关的定时任务
  - 在删除确认对话框中显示将要删除的任务数量
  - 在删除成功通知中显示任务清理信息
  - 避免孤儿任务残留，提升数据一致性和用户体验

### 技术改进
- 在TaskScheduler中新增`deleteTasksByScript(scriptId)`方法
- 增强delete-script IPC处理器的任务清理逻辑
- 改进删除脚本的用户界面反馈和信息提示
- 完善脚本与定时任务的关联管理机制

## [1.3.7] - 2025-05-27

### 新增
- 🔒 **单实例应用限制**
  - 确保同时只能运行一个脚本管理器实例
  - 尝试启动第二个实例时自动激活现有窗口
  - 跨平台支持，防止数据冲突和资源竞争
- 📁 **右键菜单增强**
  - 新增"打开文件夹"功能，可在系统文件管理器中快速定位脚本文件
  - 跨平台支持：Windows(资源管理器)、macOS(Finder)、Linux(默认文件管理器)
- 🐍 **Python脚本类型增强**
  - 新增 `.pyw` 文件扩展名支持
  - 将 `.pyw` 文件从"其他"类别归类为Python类型
  - Windows平台智能执行器选择：`.py`使用python.exe，`.pyw`使用pythonw.exe（无控制台窗口）
  - 跨平台兼容性：macOS/Linux上统一使用python命令执行.pyw文件

### 改进
- 🛡️ **用户界面安全性**
  - 禁用模态对话框点击外部区域关闭功能，防止意外关闭重要对话框
  - 禁用点击脚本卡片直接启动功能，防止误触发脚本执行
  - 保留ESC键和关闭按钮的正常功能
- � **脚本执行优化**
  - 新增 `getPythonExecutor()` 方法智能选择Python执行器
  - 优化GUI Python应用的执行体验（Windows上无控制台窗口干扰）
  - 完善文件类型检测和过滤器
- 🎯 **用户体验提升**
  - 应用启动更加稳定，避免多实例冲突
  - 右键菜单操作更加便捷，支持快速访问脚本所在文件夹
  - Python开发者工作流程优化，正确处理GUI应用脚本

### 技术细节
- 在 `main.js` 中添加单实例锁定逻辑和 `activateMainWindow()` 方法
- 在 `main.js` 中添加 `open-script-folder` IPC处理器，使用 `shell.showItemInFolder()`
- 在 `renderer.js` 中注释掉模态对话框外部点击关闭事件监听器
- 在 `renderer.js` 中添加右键菜单"打开文件夹"事件处理和 `openScriptFolder()` 方法
- 在 `file-manager.js` 中添加.pyw到支持扩展名和类型映射
- 在 `renderer.js` 中更新FILE_EXTENSIONS和脚本文件检测
- 在 `main.js` 中添加.pyw到Python脚本文件过滤器
- 在 `script-executor.js` 中实现智能Python执行器选择逻辑

## [1.3.6] - 2025-05-27

### 改进
- 📚 **文档优化**
  - 修改README.md，新增英文版 README_EN.md

## [1.3.5] - 2025-05-26

### 新增
- 🍎 **macOS 兼容性全面增强**
  - 脚本执行器支持 macOS Terminal.app 集成
  - 使用 AppleScript 在新终端窗口中启动脚本
  - 添加 `.command` 和 `.tool` 文件类型支持
  - 托盘图标使用 macOS 模板图标模式

### 改进
- 🔧 **跨平台脚本执行优化**
  - 统一工作目录处理，使用绝对路径
  - 平台特定的文件类型过滤
  - 文件对话框根据平台显示相关脚本类型
- 📁 **文件管理增强**
  - 动态生成平台相关的文件过滤器
  - 改进文件类型映射和识别

### 技术细节
- 在 `script-executor.js` 中添加 macOS 专用的脚本启动逻辑
- 在 `file-manager.js` 中实现平台特定的文件类型支持
- 在 `main.js` 中添加动态文件过滤器生成
- 优化托盘图标在 macOS 上的显示效果

## [1.3.4] - 2025-05-26

### 新增
- 🖥️ **最小化到托盘功能**
  - 新增系统托盘图标支持
  - 添加"关闭窗口时最小化到托盘"设置项
  - 托盘菜单支持快速恢复窗口和退出程序

### 改进
- 🎛️ **设置页面优化**
  - 新增"窗口行为"设置分类
  - 优化设置项布局和说明文字
  - 添加托盘图标主题选择功能

### 技术细节
- 在`main.js`中添加`createTrayIcon`方法实现托盘功能
- 在`settings.html`中添加窗口行为设置项
- 新增`trayManager.js`处理托盘相关逻辑
- 更新`preload.js`暴露新的设置项API

## [1.3.3] - 2025-05-26

### 修复
- 🛠️ **定时任务与脚本卡片联动修复**
  - 修复新建、编辑、删除、启用/禁用定时任务后，主界面脚本卡片定时信息不会自动刷新的问题
  - 现在所有定时任务相关操作后，脚本卡片会自动刷新，定时信息即时同步，无需手动刷新页面

### 改进
- 🧩 **定时任务自动命名规则优化**
  - 未填写任务名称时，自动采用脚本文件名或"脚本X的定时任务"作为任务名称，提升易用性和一致性
- 🎨 **脚本卡片内部布局优化**
  - 调整卡片内脚本名称、描述、类型标签、定时任务信息等元素的排布与间距
  - 兼容不同内容长度和屏幕尺寸，提升信息层次和美观度

### 技术细节
- 在`task-manager.js`的`createTask`、`handleEditTaskSubmit`、`deleteTask`、`toggleTask`等方法中，操作成功后均调用`window.scriptManager.refreshScripts()`，实现主界面卡片的自动刷新
- 优化了定时任务自动命名逻辑，避免无意义名称
- 优化了卡片HTML结构和CSS样式，提升信息展示效果

## [1.3.2] - 2025-05-26

### 界面优化
- 📏 **分类标签间距优化**
  - 减小标签之间的间距，使界面更紧凑
  - 调整标签内部填充，避免在小屏幕上显示不完整
  - 优化标签计数样式，使其更加紧凑

### 改进
- 🪟 **自定义确认对话框**
  - 替换原生确认对话框为自定义模态对话框
  - 保持与应用程序整体UI风格的一致性
  - 支持文本换行和居中对齐，提升可读性
- 📱 **响应式布局优化**
  - 改进小屏幕和移动设备上的显示效果
  - 优化模态对话框在小屏幕上的显示
  - 在小屏幕上使用垂直布局的按钮组
- 👆 **触摸友好改进**
  - 增大模态对话框关闭按钮的可点击区域
  - 优化按钮间距，提升触摸设备易用性
- 🔄 **脚本分类逻辑修复**
  - 统一脚本类型定义，添加静态常量
  - 修复文件类型识别与分类不一致问题
  - 添加类型不匹配时的用户提示
  - 防止重复添加相同路径的脚本
  - 确保所有UI分类与后端分类一致

### 技术细节
- 添加`showConfirmDialog`方法替代原生`confirm()`
- 为确认对话框添加专用CSS样式
- 优化小屏幕下的网格布局
- 更新.gitignore文件，排除不需要上传的文件
- 添加`ScriptManager.SCRIPT_TYPES`、`FILE_EXTENSIONS`和`TYPE_DISPLAYS`静态常量
- 简化`detectScriptType`和`getScriptTypeDisplay`方法
- 重构`updateCategoryCounts`方法，支持所有脚本类型
- 添加文件扩展名与类型匹配检查逻辑

## [1.3.1] - 2025-05-25

### 界面优化
- 🌙 **深色主题全面优化**
  - 调整背景色为更暗的色调，减少夜间使用时的眼睛疲劳
  - 提高文本对比度，使文字在深色背景下更加清晰可见
  - 修复表单样式中的硬编码颜色，确保所有元素在深色模式下可见

### 改进
- 🔔 **通知系统改进**
  - 将通知位置从右上角移动到右下角，避免遮挡设置按钮
  - 修复深色主题下通知文字看不清的问题
  - 优化通知动画效果，从底部向上滑入
- 📱 **布局优化**
  - 修复窗口最大化时卡片分布问题，使卡片能够充分利用整个屏幕宽度
  - 调整卡片大小和间距，提供更好的视觉体验
- 🎨 **图标系统升级**
  - 将emoji图标替换为专业的SVG图标
  - 为每种脚本类型提供独特的图标，更容易区分不同类型的脚本
  - 添加图标样式，确保在各种尺寸下显示正常

### 技术细节
- 重构CSS变量，确保深色主题下的一致性
- 优化SVG图标系统，提高可扩展性
- 改进通知组件的定位和样式

## [1.3.0] - 2025-05-25

### 统一名称
- 🔄 **统一项目名称为 "Scripts Manager"**
  - 将所有"脚本管理器"更新为"Scripts Manager"
  - 统一仓库名称、项目名称和产品名称
  - 更新可执行文件命名格式为"ScriptsManager-版本号"

### 改进
- 🌐 **国际化支持增强**
  - 增加双语界面元素
  - 优化中英文混合显示
- 📦 **简化包结构**
  - 更新包名为"scripts-manager"
  - 更新应用ID为"com.scriptsmanager.app"

### 技术细节
- 更新所有品牌相关引用
- 重构应用标识符
- 优化构建配置

### 修复
- 🐛 **修复面板卡片右键设置定时失效问题**
  - 修复renderer.js中的初始化代码，删除不存在的ScriptManagerApp引用
  - 修改task-manager.js中的showNotification方法，删除对不存在的window.app的引用
  - 在renderer.js中添加额外的错误检查和处理，确保模态框正确显示

## [1.2.4] - 2025-05-24

### 修复
- 🐛 **移除便携版示例脚本**
  - 解决便携版示例脚本路径问题
  - 避免"脚本文件不存在"错误
  - 便携版启动时创建空的脚本列表

### 改进
- ✨ **简化便携版体验**
  - 便携版不再包含示例脚本
  - 用户可以手动添加自己的脚本
  - 减少便携版文件大小

### 技术细节
- 从打包配置中移除example_scripts目录
- 修改ScriptManager创建空的初始脚本列表
- 确保便携版启动稳定性

## [1.2.2] - 2025-05-24

### 修复
- 🐛 **修复便携版定时任务功能完全失效问题**
  - 解决便携版中无法创建、编辑定时任务的问题
  - 修复"新建定时任务"报错问题
- 🐛 **修复便携版数据持久化问题**
  - 解决数据每次重启丢失的问题
  - 从临时目录改为用户目录存储数据
- 🐛 **修复打包后文件路径解析错误**
  - 修复`__dirname`在打包后指向只读路径的问题
  - 修复相对路径`../data/`无法正确解析的问题

### 改进
- ✨ **改进数据存储架构**
  - 数据存储位置：`~/.script-manager/`
  - 脚本配置：`~/.script-manager/scripts.json`
  - 定时任务：`~/.script-manager/tasks.json`
- 🔧 **优化打包配置**
  - 移除不必要的`extraResources`配置
  - 简化构建流程
- 📚 **完善构建文档**
  - 新增`PORTABLE_FIX.md`便携版修复指南
  - 更新`BUILD.md`构建说明

### 技术细节
- 修复ScriptManager和TaskScheduler的数据文件路径
- 使用`app.getPath('userData')`获取正确的用户数据目录
- 修复已弃用的`substr`方法，改用`substring`
- 确保便携版真正"便携"且数据持久化

## [1.2.1] - 2025-05-24

### 修复
- 修复了定时任务脚本执行失败问题（脚本文件不存在: undefined错误）
- 修复了Windows平台定时任务启动命令错误
- 修复了定时任务重复执行的无限循环问题
- 修复了任务管理界面编辑按钮无响应问题
- 确保定时任务与面板启动使用相同的启动逻辑

### 改进
- 优化了TaskScheduler的参数传递机制
- 改进了错误处理和用户反馈
- 增强了任务状态的同步和持久化
- 完善了任务编辑功能和表单验证

### 技术细节
- 在TaskScheduler中添加getScriptData方法获取完整脚本信息
- 修复executeTask方法的参数传递问题
- 实现完整的editTask方法和编辑表单界面
- 统一定时任务和面板启动的脚本执行方式

## [1.2.0] - 2025-05-24

### 新增
- ⏰ **定时任务功能**: 轻量级任务调度器
- 支持三种调度类型：间隔执行、每日定时、每周定时
- 可视化任务管理界面
- 任务创建、编辑、删除功能
- 任务启用/禁用控制
- 立即执行任务功能
- 脚本卡片定时状态显示
- 右键菜单设置定时功能
- 任务状态实时更新
- 数据持久化存储

### 技术实现
- 新增TaskScheduler类实现任务调度逻辑
- 新增TaskManager类管理任务界面
- 集成IPC通信支持定时任务操作
- 添加tasks.json数据文件存储任务信息

## [1.1.1] - 2025-05-24

### 修复
- 修复了使用相对路径的Python脚本（如hello.py）启动后立即退出的问题
- 改进了Windows平台下脚本启动时的路径解析逻辑
- 确保新启动的控制台窗口使用正确的工作目录

### 技术细节
- 在Windows平台使用绝对路径避免相对路径解析问题
- 为`start`命令添加`/D`参数指定正确的工作目录
- 统一了跨平台的路径处理方式

## [1.1.0] - 2024-12-01

### 新增
- 重构为脚本启动器模式，在独立窗口中运行脚本
- 现代化卡片网格布局界面
- 智能分类和搜索功能
- 改进的错误处理和稳定性

### 修复
- 解决GPU缓存错误问题
- 修复中文编码显示问题
- 优化用户数据目录处理

## [1.0.0] - 2024-12-01

### 新增
- 初始版本发布
- 支持Python、JavaScript、TypeScript、批处理、PowerShell和Bash脚本
- 图形化界面管理脚本
- 脚本执行和输出监控功能
- 脚本添加、编辑、删除功能
- 支持本地脚本文件管理
